"""
 This file is part of nucypher.

 nucypher is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 nucypher is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.

 You should have received a copy of the GNU Affero General Public License
 along with nucypher.  If not, see <https://www.gnu.org/licenses/>.
"""

from nucypher.characters.lawful import Ursula

ursulas_v1 = (
    '0001e57bfe9f44b819898f47bf37e5af72a0783e114100000016000000123a74656d706f726172792d646f6d61696e3a5f593d2c83aaa6a200696737d89ad9f746b867c6a04510be21f56225cbe7528f1c48326bd2b70a0dfd5c632cd274d7b6371c76ca886fe98dbd0686ebdf20e90fda6ae9f300000041b5fcdf6998f1f41532e933aa3f507222ca3bf44a54c3d355c6f2538909984b234ce7218ae72239156b39d318d2f0e8735c4d5fe236278e60913305ec362af94b1b032569686b730892f78b06bd8fe8af83307ae6db27d4fd81eaf7cceb70ff15612f02d8486449e324133937c1f9118688cf464855bee69c1e36c36228186c0b9f48f0000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949423554434341577167417749424167495551475559566c4c46726434503035616c79463576746957522f6d6377436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f77654555314e324a4752546c474e4452694f4445350a4f446b34526a5133516b597a4e305531515559334d6d45774e7a677a5a5445784e4445774868634e4d6a41774f5441354d6a417a4e6a41775768634e4d6a45770a4f5441354d6a417a4e6a4177576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a4234525455330a596b5a464f5559304e4749344d546b344f5468474e446443526a4d3352545642526a6379595441334f444e6c4d5445304d5442324d42414742797147534d34390a41674547425375424241416941324941424c73686a696177584a597237314f656143746b54467144416a72466b73644c4f454b7842795079316d6e56675a2b520a3173526d6f4d377a3743524b4b4f7856444f762b4b447355555a55324b6539497579737870675549537365556242707a674542556d6e6a775a4551554d5244760a35416f4c622b6e59326131657743717572364d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e700a4144426d416a45416a4f4c58516a65322b5a754a474845514d3468734370324f69737632537954342b4145466c47622f716c636d7537386c6c356e564737774e0a5969797736696b5a416a4541674e7a67315063514b577838554d4d78674f456378364c4d4c73356b47617176657653537050436d336a47696e445a2b725131340a3777584136536e6576327a630a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c79c',
    '0001d41c057fd1c78805aac12b0a94a405c0461a6fbb00000016000000123a74656d706f726172792d646f6d61696e3a5f593d2c5c35512cf82c363ad0510316a52bc536b7e50bc2bc26d2e7e027e89599df1f68f09fbce21e454f463a60d695400c32020a7e3e1525c36b084c0c5d62d3b4018f00000041037dce12ecc6269d2fd625a2d3f33af08144ed23a16e3c3e83fb5e97c9bb45565b09a3bddf5df1d386eed1aa8d6761b510a1aa89393f723eac53c425f3e39fec1c02d4a211f477e6eda76623846910c5cf360db9cd21e94e1ff03978edb59a6617580248680b0bd97031ef98a26153f2470d5b516fa172a9fc178c8bc5b7fe1566cab0000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942354443434157716741774942416749554f392f69322f3248546754627958744f362b386a36655a5866336f77436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f77654751304d574d774e54646d5a44466a4e7a67340a4d44564251554d784d6b497751546b30595451774e574d774e44597851545a47516d49774868634e4d6a41774f5441354d6a417a4e6a457a5768634e4d6a45770a4f5441354d6a417a4e6a457a576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a42345a4451780a597a41314e325a6b4d574d334f4467774e554642517a4579516a42424f5452684e444131597a41304e6a46424e6b5a43596a42324d42414742797147534d34390a41674547425375424241416941324941424e744861433952416d722f56686548423236615656732f39327346792f724f43484f51654377766c6b5767726233610a2f467331435a69474a4c6b387549507858377a4344736e3353574c63776948794e39645153596f4e7475537862414a41655859617630747936534775704835550a463277527a65637564566c4e667759302f614d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e6f0a4144426c416a4541353479656659377a416d6b797866495751657a6134514f745350614e4730446646494a3544437239624a4b314953635377384a7167454b730a6d3238764b68567a416a4230536e6e58364f764555507a6e7553665a46426e5634323069622b35474f6f794f4e425772757762676578627177554462613344440a443564727879724663616f3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c79d',
    '0001f1f6619b38a98d6de0800f1defc0a6399eb6d30c00000016000000123a74656d706f726172792d646f6d61696e3a5f593d2cdbdd7fa68737d931a51af7c0af7cf2c8a40ed076ce1b07d03c53705725ae5577ee3c4e0c820cfd3603a6b58e9ae1eb82f86ddafa2c666932a6b6d89fff69f58500000041d3847defa8d5a51a7bf4162ced072ed47991f5d337738bb8388e4a98bc6fd69f3f7e5da723705c9a1fdb32f36c4c00b9bf172327c43a5f203c43fe4b86d1df5f1b02fd072b2c3533ca5db8cddfb05692181dec80bc0a4b5ae3fe66b08a84fe3f4b150230b0dabd08d49c1bc0455fb6e96cf30f70669b55534313ca506a473e9e5f1fc0000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942354443434157716741774942416749556231556a3235346667744b325a7173626d5a59523437306c702b4577436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f7765455978526a59324d546c434d7a68424f54686b0a4e6b526c4d4467774d4559785247566d517a42684e6a4d354f5756434e6d517a4d454d774868634e4d6a41774f5441354d6a417a4e6a49325768634e4d6a45770a4f5441354d6a417a4e6a4932576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a4234526a46470a4e6a59784f55497a4f4545354f475132524755774f444177526a46455a575a444d4745324d7a6b355a5549325a444d77517a42324d42414742797147534d34390a416745474253754242414169413249414243534b47704b49344f4b7a745249376834574c5043544c33744231395a684e463166653370544974464b5472554b700a4a4f635178732f6e544d4f64696e3949716f3967676e566b624e507a7172524f4268653774772f486c524b6c4675727a745755464f703635326976446c3351540a466f784a62557254483330416e644b4f334b4d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e6f0a4144426c416a45413835723550492b57447873534e49414b385a2b4862643666364c2f593170456959654e5a6a67673668514f2f302b53734d476a6159612b420a46672f446a374838416a4230704d454f4a56747054747945524970574274694d42634d67362f637356695449767654586c5666672f686f3373587a4d6572627a0a5647746d646a6368726b513d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c79e',
    '0001f7edc8fa1ecc32967f827c9043fcae6ba73afa5c00000016000000123a74656d706f726172792d646f6d61696e3a5f593d2cf704a58cc9ac7709e992b28e6ba14b89ce4e5a84904743103a580dd09158d9858246f73a2362999eaebee6309444c1f3fcf288c24e32c6f12e70829b7dbe579500000041f51c88ce693adb33d439c91c23cfc00f03737d7553ac86fd7d3350171212baad4696f83ebdc5ba54c005c55039b2479b88a1d200af718385fdb67d212bbc59641c03170cb65c5d50b0a9f2c93943089b2414f0682face1f1b5174843352ce5951c3f0256201f115d565e42c75783784734e790d07e8ab48963c024a85a2974ef15b09b000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942354443434157716741774942416749554332686a4b4e6163382f6d61416330716578644330373341582b4977436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f77654559335257526a4f455a424d575644597a4d790a4f545933526a67794e304d354d44517a526d4e425a545a695954637a59575a424e574d774868634e4d6a41774f5441354d6a417a4e6a4d355768634e4d6a45770a4f5441354d6a417a4e6a4d35576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a4234526a64460a5a474d34526b45785a554e6a4d7a49354e6a64474f444933517a6b774e444e475930466c4e6d4a684e7a4e685a6b4531597a42324d42414742797147534d34390a416745474253754242414169413249414245645a6a654842726347644f454976424f43446a4b65704d6f303258526e79304b71562f3862747339516a3667504a0a763334797642466b31626a4d63374648562b47525a617176545a757865366c694d6a57666b51354c6c50763166325647474a792f5130452b4430636c3353442f0a4f32764245324b5432565244792b596e2b714d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e6f0a4144426c416a4541776b326d7a6233574668735533766d4268722b4c4768442f6b48494d6c65477342584b796c4363636741784b70336d4e6e4861467369364e0a6c6963475a72584d416a424268727363567a683558307a384a49497468396337584a78556131664d6d6d5a63336b6e4c486f585a7a4b4c366878346e492f4a310a2f71676a6e714e6e76676f3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c79f',
    '00014cceba2d7d2b4fdce4304d3e09a1fea9fbeb152800000016000000123a74656d706f726172792d646f6d61696e3a5f593d2c8dd3177aa48594ad5bd4d289055b64ae990a9b8b70434da92ea1599bf766b600831a759b9c94b860d540b15f71d0c9bbc35953e5c306bb8b8f91da9298432b5c000000411763c36944ce97078383378af2499914a5cadc1404bd25a40a411844649ef9913c719f68c9c557037722288e9fb0e650f3a958a3c1647460e79986bc49d2d0fd1b0332a966aa2a2b5ee449d41ae572dd0bffab7b3c7d7668227115924822116bfdac02259a2a302a032b7e2d953d8c86fc8a6247bb2b81d597791b9c3d90e206d063f8000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942355443434157716741774942416749556458514b3042527a4c65377867746451446c75762f392f6e72536377436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f77654452445132564359544a6b4e305179516a526d0a5a474e464e444d774e47517a5a5441355954466d5a5745355a6d4a46596a45314d6a67774868634e4d6a41774f5441354d6a417a4e6a55795768634e4d6a45770a4f5441354d6a417a4e6a5579576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a42344e454e440a5a554a684d6d513352444a434e475a6b593055304d7a41305a444e6c4d446c684d575a6c59546c6d596b56694d5455794f4442324d42414742797147534d34390a4167454742537542424141694132494142476d6b4a4867315172706a54333334676f6c3039746179316d792f6e3935792b612f453844656d4f704b51693258580a48796b2f6d3739436b4d574f494f2f38615a6c7463704f464c2b6159734e58634d7a476865785955616c62424e5254514b763661624f736136365853325434580a59757675724b5664394241466e43514d594b4d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e700a4144426d416a45416d55456250694d772b5a44427531757558714131554a633373654668524b44736e4d5a39735a77384d4e5332634348655379474e306342780a62645575442b4143416a4541364b612f6944586d395032654762446d774b494c50324e4b4f664d7173724c446a76304c6446543552636a5332502f317658464d0a4d5534386a55766c364957310a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c7a0',
    '00013da8d322cb2435da26e9c9fee670f9fb7fe74e4900000016000000123a74656d706f726172792d646f6d61696e3a5f593d2cbbff43453245b9fb1d58606cedfd18cafef68fd648c324ee9da076ac79839ff7b9de3756df26a055ae9e3ed2637b6638a785572846f133c8df3ce747abf7e5df0000004102edca7e306c31fe06af9f43916e1128eb16ba29415f1d01211f2530c0cb92ce13eb7174ca5fc1aed5ff022bda01b6b2ab2beef9c3a3f424a5b4baf43368178d1b03942781ebb8f470b31f758a4fa1e2c310ebd39140e772fdf16b64d85af8c2a3380304e6a8579f623d3c8600e8f98422be024ad06dee2948bef462121105210a8a76000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942354443434157716741774942416749556664442b5a4966513574624d6559693453784770334c477a72685177436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f7765444e45515468454d7a4979513049794e444d310a5a4545794e6b5535517a6c6d525555324e7a426d4f575a434e305a6c4e7a52464e446b774868634e4d6a41774f5441354d6a417a4e7a41325768634e4d6a45770a4f5441354d6a417a4e7a4132576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a42344d3052420a4f45517a4d6a4a44516a49304d7a566b5154493252546c444f575a46525459334d4759355a6b4933526d55334e4555304f5442324d42414742797147534d34390a4167454742537542424141694132494142426463477a7a5a786865554c3235576453796d5a6e714f696f572b4c4d5753543338694759526e347370424a574c6d0a6a6d59674d654557747a48364664714658676b4f592f6e546c325449344858494c7243706d3475356664577564585456666f34684966306e4f4f2b775a6a37670a564d3076416d344f343037783877372f4d364d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e6f0a4144426c416a45417a6d4d364c4e59735a732f71555a697668444767506870794d754c7431356b39594a2f677847676e7332546431665a43623550456d4a39700a6e426b4355583043416a4131767631426b48534f662f3761635a4a784866556c664152597165536e582f39653338703831326a66514a6b684177687356365a430a6f314c69374a47576d32383d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c7a1',
    '0001dbc23ae43a150ff8884b02cea117b22d1c3b979600000016000000123a74656d706f726172792d646f6d61696e3a5f593d2c3a9a1f028dbdd0723bd244bc3e06a3b4d2b254622dc9b5e9469a0f00fedcb0b108bcb9c310aaacb15a6714d6376b87d898bf7f3b8376168dd41e636b6b0664aa000000419413e0ed684060ebdc48cfacfcff64550affa652d89bd90dcba0644228d0f2d03b6397dec6d55ca7e6257fc143d413d8e3a5ac265a9ac22b0c27e00066908c4d1b036633eee409ce433fbd9a504a97f4b3efa5506a0ce1fdc77ca573c579a9b798e30360d5967444efc24fd2f4839a75776071d8a050c1450b00b29a016edb7e1bcbde000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942355443434157716741774942416749555a46386c784d3873524a34784231464d2f64702b3945713735475577436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f7765455269597a497a515555304d3245784e54426d0a5a6a67344f4452434d444a445a5745784d5464694d6a4a454d574d7a596a6b334f5459774868634e4d6a41774f5441354d6a417a4e7a49775768634e4d6a45770a4f5441354d6a417a4e7a4977576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a423452474a6a0a4d6a4e425254517a595445314d475a6d4f4467344e4549774d6b4e6c595445784e3249794d6b5178597a4e694f5463354e6a42324d42414742797147534d34390a41674547425375424241416941324941424232655646744e785848584b4b433036503630384b4e306666336a5772302f3357646f4875477a5957684f445669390a4437724453425071394f72346276435274784c6579586a4b43694d764c4c493548496e7843714b763163747463735851474b6c6d3733304841494238344a79710a7a47674e57647a534c446c416654776e2b614d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e700a4144426d416a4541315366304c616a713044524946735765746d7a487a5a5a396f4c47547a6e39693973306a38676f37447633465230687976596c77383075390a2b744a5965617279416a45412b762b4c2b753841385342564c376e50656166632b2f4b627042612f304831547448774550615772395a4d41364d6d65453631710a572f59586c6138775848462f0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c7a2',
    '000168e527780872cda0216ba0d8fbd58b67a5d5e35100000016000000123a74656d706f726172792d646f6d61696e3a5f593d2d856c42a3d8ed363eea5b59c5b63b1b9be4a9ef0ccfe391a34ffc0bf387caa4b9cb0f778347a94bfa996edf5adbf943dcc9dce900d2df1c7dd63593a0cf34c61e00000041369704de40d33e0f6d2599757cebbf5f61545fdc4c720e2627cfdb288eba4da55207f08ff2a36e4a78be38888f536f25658a98d7c408ddbc82d61f2082862bea1b03b52e5ae3cfe92a46a12f3123b039d1d81e32343ee7ace499882af233c78277a203c81667f20095849d68637b2c83c4c3473e074d76d1869f7e148b366cd5502c85000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942354443434157716741774942416749555371682f4b6838546742706f5873634b75716d774e79377556345977436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f7765445934525455794e7a63344d4467334d6d4e6b0a595441794d545a435954426b4f475a4352445534596a5933595456454e57557a4e5445774868634e4d6a41774f5441354d6a417a4e7a4d305768634e4d6a45770a4f5441354d6a417a4e7a4d30576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a42344e6a68460a4e5449334e7a67774f446379593252684d4449784e6b4a684d4751345a6b4a454e5468694e6a64684e5551315a544d314d5442324d42414742797147534d34390a41674547425375424241416941324941424c64622b43334d5a674e39472f6672564c6a3679686e6472713331496a5a45544c5a4f464162622f52536d354d6e570a6b622f6c7264335162586272353238417550626e6579524361473374494e4b492b5977714f54483963785a6b6c33516e38456355384e6b54365035593131384b0a7831383367776c53674642695958366579364d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e6f0a4144426c416a4541325246466649475532673146734361446c4f59427a426449313375656144727a565245494c63577647635968543835764658737435374c350a46534b6f72435475416a42726c5a33337669677852764f6f304964345938645142346f425848716c786949422b584f4b7a4a4c735a38534532706a3172584d2f0a477a2b774c5139576144343d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c7a3',
    '00015a83529ff76ac5723a87008c4d9b436ad4ca7d2800000016000000123a74656d706f726172792d646f6d61696e3a5f593d2dab01fed200ede90a6cb05fb3ede24a1ac6db11fb5371ef25248862dc4ea49943042df65df723434616887fd83c18933be508abdbd4c9ffba4113f28ada18524b000000416e47ce353aa3f4c02b7b54674b14e537168db185db950e9c9570e93a7e7b6c805691027167700749f17088d679e933ad8a651ab284f3fb947979674d6b248e571b02213cfdf1b442ea500febe9bf7a50eed7bf1956620df47d2626f7c3da8e027f6e025825fa58fcca874e460a586e8e7ebd32518afbdb56014b619eccb1759650c164000002cd2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494942354443434157716741774942416749554f576a5a7068595869504270356b706a306a585063585a5648664977436759494b6f5a497a6a3045417751770a535445534d424147413155454177774a4d5449334c6a41754d4334784d544d774d5159445651524244436f77654456424f444d314d6a6c6d5a6a633251574d310a4e7a497a515467334d444134597a52454f5549304d7a5a42524452445154646b4d6a67774868634e4d6a41774f5441354d6a417a4e7a51345768634e4d6a45770a4f5441354d6a417a4e7a5134576a424a4d524977454159445651514444416b784d6a63754d4334774c6a45784d7a417842674e564245454d4b6a42344e5545340a4d7a55794f575a6d4e7a5a42597a55334d6a4e424f4463774d44686a4e455135516a517a4e6b46454e454e424e3251794f4442324d42414742797147534d34390a4167454742537542424141694132494142424e595470424a643566346b44346876557a625a4133434d6769362b463262316152374d43576e2b353633546c37710a643773643066456761684364726e5444333452415756652b59496f582b596148507543776e314d4e6146396472596a48315651514f3051715753616375424b500a5972696a55465253315863504c397a6e4a614d544d424577447759445652305242416777426f6345667741414154414b42676771686b6a4f5051514442414e6f0a4144426c416a42716f7a6334554b6c4d5665464a6c2f314a4a6f2b6d354954337032774e5842697749313876663530444b4a777a792f376b6672714f494b70610a333868484a6673434d514444562f62656172346654643245724c4c575643626e786e41384679756b716b4867774650646b4275695a59326f4d36575a78614b780a576b502f38587745545a4d3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a0000000e3132372e302e302e313a0000c7a4',
)

versioned_ursulas = {
    1: ursulas_v1,
}


def test_deserialize_ursulas():
    fossilized_ursula = bytes.fromhex(ursulas_v1[0])

    version, _ = Ursula.version_splitter(fossilized_ursula, return_remainder=True)
    assert version == 1

    resurrected_ursula = Ursula.from_bytes(fossilized_ursula, fail_fast=True)
